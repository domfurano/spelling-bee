{"id":"../node_modules/@mesa-engine/core/lib/family.js","dependencies":[{"name":"/Users/z002m1n/PersonalProjects/spelling-bee/node_modules/@mesa-engine/core/lib/family.js.map","includedInParent":true,"mtime":499162500000},{"name":"/Users/z002m1n/PersonalProjects/spelling-bee/package.json","includedInParent":true,"mtime":1570033957589},{"name":"/Users/z002m1n/PersonalProjects/spelling-bee/node_modules/@mesa-engine/core/package.json","includedInParent":true,"mtime":1570055500767}],"generated":{"js":"\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar AbstractFamily = (function () {\n    function AbstractFamily(engine, include, exclude) {\n        var _this = this;\n        this.includesEntity = function (entity) {\n            for (var _i = 0, _a = _this._include; _i < _a.length; _i++) {\n                var include = _a[_i];\n                if (!entity.hasComponent(include)) {\n                    return false;\n                }\n            }\n            for (var _b = 0, _c = _this._exclude; _b < _c.length; _b++) {\n                var exclude = _c[_b];\n                if (entity.hasComponent(exclude)) {\n                    return false;\n                }\n            }\n            return true;\n        };\n        this._engine = engine;\n        this._include = Object.freeze(include.slice(0));\n        this._exclude = Object.freeze(exclude.slice(0));\n    }\n    Object.defineProperty(AbstractFamily.prototype, \"engine\", {\n        get: function () {\n            return this._engine;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return AbstractFamily;\n}());\nvar CachedFamily = (function (_super) {\n    __extends(CachedFamily, _super);\n    function CachedFamily(engine, include, exclude) {\n        var _this = _super.call(this, engine, include, exclude) || this;\n        _this.onEntityChanged = function (entity) {\n            var index = _this._entities.indexOf(entity);\n            if (index === -1) {\n                _this._entities.push(entity);\n                entity.addListener(_this.onEntityChanged);\n            }\n            _this._needEntityRefresh = true;\n        };\n        var allEntities = _this.engine.entities;\n        _this._entities = allEntities.filter(_this.includesEntity);\n        _this.engine.addEntityListener(_this);\n        for (var _i = 0, allEntities_1 = allEntities; _i < allEntities_1.length; _i++) {\n            var entity = allEntities_1[_i];\n            entity.addListener(_this.onEntityAdded);\n        }\n        _this._needEntityRefresh = false;\n        return _this;\n    }\n    Object.defineProperty(CachedFamily.prototype, \"entities\", {\n        get: function () {\n            if (this._needEntityRefresh) {\n                this._needEntityRefresh = false;\n                this._entities = this._entities.filter(this.includesEntity);\n            }\n            return Object.freeze(this._entities.slice(0));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    CachedFamily.prototype.onEntityAdded = function (entity) {\n        var index = this._entities.indexOf(entity);\n        if (index === -1) {\n            this._entities.push(entity);\n            this._needEntityRefresh = true;\n            entity.addListener(this.onEntityChanged);\n        }\n    };\n    CachedFamily.prototype.onEntityRemoved = function (entity) {\n        var index = this._entities.indexOf(entity);\n        if (index !== -1) {\n            var entity_1 = this._entities[index];\n            this._entities.splice(index, 1);\n            entity_1.removeListener(this.onEntityChanged);\n        }\n    };\n    return CachedFamily;\n}(AbstractFamily));\nvar NonCachedFamily = (function (_super) {\n    __extends(NonCachedFamily, _super);\n    function NonCachedFamily() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(NonCachedFamily.prototype, \"entities\", {\n        get: function () {\n            return this.engine.entities.filter(this.includesEntity);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return NonCachedFamily;\n}(AbstractFamily));\nvar FamilyBuilder = (function () {\n    function FamilyBuilder(engine) {\n        this._engine = engine || null;\n        this._include = [];\n        this._exclude = [];\n        this._cached = true;\n    }\n    FamilyBuilder.prototype.include = function () {\n        var _a;\n        var classes = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            classes[_i] = arguments[_i];\n        }\n        (_a = this._include).push.apply(_a, classes);\n        return this;\n    };\n    FamilyBuilder.prototype.exclude = function () {\n        var _a;\n        var classes = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            classes[_i] = arguments[_i];\n        }\n        (_a = this._exclude).push.apply(_a, classes);\n        return this;\n    };\n    FamilyBuilder.prototype.changeEngine = function (engine) {\n        this._engine = engine;\n        return this;\n    };\n    FamilyBuilder.prototype.setCached = function (cached) {\n        this._cached = cached;\n    };\n    FamilyBuilder.prototype.build = function () {\n        if (!this._engine) {\n            throw new Error(\"Family should always belong to an engine.\");\n        }\n        if (!this._cached) {\n            return new NonCachedFamily(this._engine, this._include, this._exclude);\n        }\n        return new CachedFamily(this._engine, this._include, this._exclude);\n    };\n    return FamilyBuilder;\n}());\nexports.FamilyBuilder = FamilyBuilder;\n"},"sourceMaps":{"js":{"version":3,"file":"family.js","sourceRoot":"","sources":["../src/family.ts"],"names":[],"mappings":"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","sourcesContent":[null]}},"error":null,"hash":"a73a0ab05c63cc4e69b5985ce851126e","cacheData":{"env":{}}}